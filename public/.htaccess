
# --- LiteSpeed public cache (si disponible sur l'hébergeur) ---
<IfModule LiteSpeed>
  # Indique à LiteSpeed d'essayer de mettre en cache le contenu public.
  # LSCache respectera les headers Cache-Control. On définit ces headers plus bas.
  CacheEnable public /
</IfModule>

# --- Compression (gzip / brotli si le serveur le permet) ---
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css application/javascript application/json application/xml
</IfModule>

# --- ETag / Last-Modified (laisser activés ou désactiver ETag si besoin) ---
# FileETag MTime Size

# --- Expires & Cache-Control: 1h for HTML, 1 year for hashed static assets ---
<IfModule mod_expires.c>
  ExpiresActive On

  # Default: 1 year for most static assets
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType text/javascript "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType application/x-javascript "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType image/x-icon "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType application/font-woff "access plus 1 year"
  ExpiresByType application/octet-stream "access plus 1 year"
  ExpiresByType application/pdf "access plus 1 year"
  ExpiresByType application/manifest+json "access plus 1 year"

  # HTML: courte durée (1 heure) pour que le navigateur vérifie les nouvelles versions du HTML
  ExpiresByType text/html "access plus 1 hour"

</IfModule>

# Header directives plus explicites (Cache-Control)
<IfModule mod_headers.c>
  # Pour les fichiers HTML : 1 heure
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "public, max-age=3600, must-revalidate"
  </FilesMatch>

  # Pour les assets : 1 an et immutable — utilisé pour les fichiers buildés avec hash dans leur nom
  <FilesMatch "\.(?:css|js|jpg|jpeg|png|gif|svg|ico|webp|woff|woff2|ttf|eot|otf|map)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
</IfModule>

# --- Sécurité / bonne pratique headers ---
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set X-XSS-Protection "1; mode=block"
</IfModule>
